<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Click to Nowhere</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/addons/p5.sound.min.js"></script>
  <style>
    body { margin: 0; font-family: 'Georgia', serif; background: #000; color: white; }
    canvas { display: block; }
    .buttons {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 10;
    }
    .buttons button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #444;
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }
    .buttons button:hover {
      background-color: #666;
    }
  </style>
</head>
<body>
<div class="buttons">
  <button onclick="changeMode(0)">이방인</button>
  <button onclick="changeMode(1)">고도</button>
  <button onclick="changeMode(2)">자기 앞의 생</button>
  <button onclick="changeMode(3)">어린 왕자</button>
</div>
<script>
let mode = 0;
let messages = [
  "이방인: 나는 어머니가 죽었다는 소식을 들었다.",
  "고도: 기다리자. 아무 일도 일어나지 않는다.",
  "자기 앞의 생: 모모는 세상에서 가장 외로운 아이였다.",
  "어린 왕자: 중요한 것은 눈에 보이지 않아."
];
let bgColors = ["#c0c0c0", "#f2f2f2", "#ffeedb", "#d1e8e2"];
let starX = [], starY = [], starAlpha = [];
let clickStars = [];
let bulletHoles = [];
let sounds = [], gunshot;

function preload() {
  soundFormats('mp3');
  sounds[0] = loadSound('meursault.mp3');
  sounds[1] = loadSound('waiting.mp3');
  sounds[2] = loadSound('momo.mp3');
  sounds[3] = loadSound('prince.mp3');
  gunshot = loadSound('gunshot.mp3'); // 총소리 추가
}

function setup() {
  createCanvas(windowWidth, windowHeight);
  textAlign(CENTER, CENTER);
  textSize(28);
  fill(30);
  noStroke();

  for (let i = 0; i < 100; i++) {
    starX.push(random(width));
    starY.push(random(height));
    starAlpha.push(random(50, 255));
  }
}

function draw() {
  background(bgColors[mode]);

  if (mode === 3) {
    drawStars();
    drawClickStars();
  }

  if (mode === 0) {
    drawBulletHoles();
  }

  fill(30);
  text(messages[mode], width / 2, height / 2);

  if (mode === 1) {
    textSize(16);
    text("…", width / 2, height / 2 + 40);
  }
}

function drawStars() {
  for (let i = 0; i < starX.length; i++) {
    fill(255, 255, 255, starAlpha[i]);
    circle(starX[i], starY[i], 2);
    starAlpha[i] += random(-2, 2);
    starAlpha[i] = constrain(starAlpha[i], 50, 255);
  }
}

function drawClickStars() {
  for (let s of clickStars) {
    fill(255, 255, 0, 200);
    star(s.x, s.y, 5, 12, 5);
  }
}

function drawBulletHoles() {
  for (let b of bulletHoles) {
    fill(50);
    circle(b.x, b.y, 15);
    fill(0);
    circle(b.x, b.y, 6);
  }
}

function star(x, y, radius1, radius2, npoints) {
  let angle = TWO_PI / npoints;
  let halfAngle = angle / 2.0;
  beginShape();
  for (let a = 0; a < TWO_PI; a += angle) {
    let sx = x + cos(a) * radius2;
    let sy = y + sin(a) * radius2;
    vertex(sx, sy);
    sx = x + cos(a + halfAngle) * radius1;
    sy = y + sin(a + halfAngle) * radius1;
    vertex(sx, sy);
  }
  endShape(CLOSE);
}

function stopAllSounds() {
  for (let s of sounds) {
    if (s && s.isPlaying()) s.stop();
  }
}

function changeMode(index) {
  stopAllSounds();
  mode = index;
  if (sounds[mode]) {
    sounds[mode].loop();
  }
}

function mousePressed() {
  if (mode === 0) {
    bulletHoles.push({ x: mouseX, y: mouseY });
    if (gunshot) gunshot.play();
  } else if (mode === 3) {
    clickStars.push({ x: mouseX, y: mouseY });
  }
}
</script>
</body>
</html>